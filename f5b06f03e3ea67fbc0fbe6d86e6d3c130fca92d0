{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "eaf95477_02203d9b",
        "filename": "games-performance-tuner/core/memory_telemetry.cpp",
        "patchSetId": 2
      },
      "lineNbr": 168,
      "author": {
        "id": 1970910
      },
      "writtenOn": "2023-09-07T08:35:11Z",
      "side": 1,
      "message": "Are we sure that this is the right solution? To me it seems like lazy initialization in `SetEnabled` seems correct, instead I think we should check if it is initialized/enabled in the callers that do `UpdateOomScore` \u0026 `UpdateMemInfo`. Otherwise we would be doing unnecessary tracking when the default memoryinfo provider is never enabled.",
      "revId": "f5b06f03e3ea67fbc0fbe6d86e6d3c130fca92d0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "445c6182_4e76b00d",
        "filename": "games-performance-tuner/core/memory_telemetry.cpp",
        "patchSetId": 2
      },
      "lineNbr": 168,
      "author": {
        "id": 1940280
      },
      "writtenOn": "2023-09-07T10:30:03Z",
      "side": 1,
      "message": "Ah this is my fault. I asked Baris in person \"Why isn\u0027t this done in an init function or in the constructor?\" which caused the changes from the previous fix.\n\n\u003e instead I think we should check if it is initialized/enabled in the callers that do UpdateOomScore \u0026 UpdateMemInfo\n\nSo in this case this \"fix\" would be to return early from UpdateOomScore? As it doesn\u0027t make sense to call it before SetEnabled?\n\nSo the purpose of \"memInfo.initialized\" is to prevent unnecessary calls to \"android_process_.myPid()\" which is expensive because it calls into the JVM",
      "parentUuid": "eaf95477_02203d9b",
      "revId": "f5b06f03e3ea67fbc0fbe6d86e6d3c130fca92d0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2803bcb6_7e8d5d79",
        "filename": "games-performance-tuner/core/memory_telemetry.cpp",
        "patchSetId": 2
      },
      "lineNbr": 168,
      "author": {
        "id": 1940280
      },
      "writtenOn": "2023-09-07T10:31:29Z",
      "side": 1,
      "message": "I meant to say *\"return early from UpdateOomScore and UpdateMemInfo\"",
      "parentUuid": "445c6182_4e76b00d",
      "revId": "f5b06f03e3ea67fbc0fbe6d86e6d3c130fca92d0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3b6ebd66_3157eb94",
        "filename": "games-performance-tuner/core/memory_telemetry.cpp",
        "patchSetId": 2
      },
      "lineNbr": 168,
      "author": {
        "id": 1970910
      },
      "writtenOn": "2023-09-07T10:39:43Z",
      "side": 1,
      "message": "That is what my understanding is - but after checking the API `TuningFork_enableMemoryRecording` says by default it is enabled, which is not the case currently. I recommend making it consistent (maybe go with the API because otherwise the interface will be wrong).",
      "parentUuid": "2803bcb6_7e8d5d79",
      "revId": "f5b06f03e3ea67fbc0fbe6d86e6d3c130fca92d0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d6c55f66_aa91f5c3",
        "filename": "games-performance-tuner/core/memory_telemetry.cpp",
        "patchSetId": 2
      },
      "lineNbr": 168,
      "author": {
        "id": 1568678
      },
      "writtenOn": "2023-09-07T12:51:29Z",
      "side": 1,
      "message": "I do think this is the correct way to do it. enabled_ is set to true by default so the memory provider starts enabled. If the memory provider is not enabled these functions are never called anyway so I don\u0027t think it\u0027s necessary to add such logic to every single function in memory provider. The only problem here is that enabled_ is true by default but setEnabled() isn\u0027t called by default; so it is not wise to put initialization code in there.",
      "parentUuid": "3b6ebd66_3157eb94",
      "revId": "f5b06f03e3ea67fbc0fbe6d86e6d3c130fca92d0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "028b2bcb_586defe7",
        "filename": "games-performance-tuner/core/memory_telemetry.cpp",
        "patchSetId": 2
      },
      "lineNbr": 168,
      "author": {
        "id": 1970910
      },
      "writtenOn": "2023-09-07T12:56:21Z",
      "side": 1,
      "message": "ok that makes sense, basically the problem here is that implicitly `enabled_` is set to true - without actually doing the work for enabling the first time.",
      "parentUuid": "d6c55f66_aa91f5c3",
      "revId": "f5b06f03e3ea67fbc0fbe6d86e6d3c130fca92d0",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}